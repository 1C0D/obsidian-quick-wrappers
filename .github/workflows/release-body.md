added time format and code improved